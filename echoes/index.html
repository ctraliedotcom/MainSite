<html>
    <head>
        <link href='https://fonts.googleapis.com/css?family=Lexend Deca' rel='stylesheet'>
    <style>
        body {
            background-color: #f8fbf8;
            padding: 20px;
            font-family: 'Lexend Deca', serif;
        }
        header {
            background-color: #f4f4f4;
            padding: 20px;
            text-align: center;
            font-family: 'Roboto Slab', serif;
        }
        h1 {
            font-size: 42px;
            margin: 0;
            color: #333;
        }
        h2 {
            font-size: 36px;
            margin: 0;
            color: #333;
        }
        h3 {
            font-size: 24px;
            margin: 0;
            color: #333;
        }
        p {
            font-size: 16px;
            color: #323030;
        }
        td, th {
        border: 1px solid #ddd;
        padding: 8px;
        }

        tr:nth-child(even){background-color: #f2f2f2;}

        tr:hover {background-color: #ddd;}

        th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #04AA6D;
            color: white;
        }

        /* unvisited link */
        a:link {
        color: rgb(13, 108, 43);
        }

        /* visited link */
        a:visited {
        color: green;
        }

        /* mouse over link */
        a:hover {
        color: rgb(13, 108, 43);
        }

        /* selected link */
        a:active {
        color: blue;
        }


    </style>

    </head>
<body>
<h2>Hidden Echoes Survive Training in Audio To Audio Generative Instrument Models</h2>
<p></p>

<h3>Christopher J. Tralie, Matt Amery, Benjamin Douglas, Ian Utz</h3>

<ul>
    <li>
        <h3><a href = "writeup.pdf">Writeup</a></h3>
    </li>
    <li>
        <h3><a href = "https://github.com/ctralie/Audio2AudioEchoes">Source Code</a></h3>
    </li>
</ul>

<h3>Abstract</h3>
<p>
    As generative techniques pervade the audio domain, there has been increasing interest in tracing back through these complicated models to understand how they draw on their training data to synthesize new examples, both to ensure that they use properly licensed data and also to elucidate their black box behavior. In this paper, we show that if imperceptible echoes are hidden in the training data, a wide variety of audio to audio architectures (differentiable digital signal processing (<a href = "https://github.com/ctralie/ddsp">DDSP</a>), Realtime Audio Variational autoEncoder (<a href = "https://github.com/ctralie/RAVE">RAVE</a>), and ``<a href = "https://github.com/ctralie/dance-diffusion">Dance Diffusion</a>'') will reproduce these echoes in their outputs. Hiding a single echo is particularly robust across all architectures, but we also show promising results hiding longer time spread echo patterns for an increased information capacity. We conclude by showing that echoes make their way into fine tuned models, that they survive mixing/demixing, and that they survive pitch shift augmentation during training. Hence, this simple, classical idea in watermarking shows significant promise for tagging generative audio models. 
</p>

<HR>

<h3>Supplementary Material</h3>
<p>
    Below are a few examples of style transfer from a few of the models we trained.  Drums models are trained on the <a href = "https://magenta.tensorflow.org/datasets/groove">groove dataset</a>, guitar models are trained on <a href = "https://guitarset.weebly.com/">guitarset</a>, and vocal models are trained on <a href = "https://zenodo.org/records/1203819">vocalset</a>.  For models with echoes/echo patterns, that same echo pattern was embedded in each file of the training set before training.  See our <a href = "writeup.pdf">paper</a> for statistics on much more extensive experiments.
</p>
<p>
    Notes:
    <Ul>
        <li>
            Each example is a single sample from the respective models; there is some randomization present during every style transfer, so results will vary under the same conditions
        </li>
        <li>
            The models were not optimized for audio quality; they were meant as a proof of concept for audio to audio style transfer.
        </li>
        <li>
            All dance diffusion results presented here use a noise factor &eta;=0.2.  Higher noise factors sound less like the input audio and are more random
        </li>
    </Ul>
</p>


<h3>Input Sample</h3>
<p>
    A 30 second clip from <a href = "https://www.youtube.com/watch?v=38XTwilL4rA&list=PLBshfW3Qrutzs11LRRbozRxuf8qhzlJVb">Prince - Loring Park Sessions '77</a>
</p>
<audio controls>
    <source src="prince.mp3" type="audio/mpeg">
  Your browser does not support the audio element.
  </audio> 
<p></p>












<h3>Dance Diffusion Style Transfers: Drums</h3>
        
<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="dd_prince_groove_0.2_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="dd_prince_groove_0.2_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="dd_prince_groove_0.2_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="dd_prince_groove_0.2_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "DDCepstra_groove.svg"  width="60%"></p>



<h3>Dance Diffusion Style Transfers: Acoustic Guitar</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="dd_prince_guitarset_0.2_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="dd_prince_guitarset_0.2_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="dd_prince_guitarset_0.2_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="dd_prince_guitarset_0.2_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "DDCepstra_guitarset.svg"  width="60%"></p>



<h3>Dance Diffusion Style Transfers: Vocals</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="dd_prince_vocalset_0.2_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="dd_prince_vocalset_0.2_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="dd_prince_vocalset_0.2_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="dd_prince_vocalset_0.2_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "DDCepstra_vocalset.svg"  width="60%"></p>



<!--

    <h3>DDSP Style Transfers: Drums</h3>
    
    <table style="width:80%;">
        <tr>
            <td>
                <h4>Clean</h4>
                <audio controls>
                    <source src="ddsp_prince_groove_clean.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>50 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_groove_50.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>75 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_groove_75.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>100 Echo</h4>
    <audio controls>
        <source src="ddsp_prince_groove_100.m4a" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio> 
            </td>
        </tr>
    </table>
    
    <p><img src = "DDSPCepstra_groove.svg"  width="60%"></p>
    
    
    
    <h3>DDSP Style Transfers: Acoustic Guitar</h3>
    
    <table style="width:80%;">
        <tr>
            <td>
                <h4>Clean</h4>
                <audio controls>
                    <source src="ddsp_prince_guitarset_clean.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>50 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_guitarset_50.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>75 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_guitarset_75.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>100 Echo</h4>
    <audio controls>
        <source src="ddsp_prince_guitarset_100.m4a" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio> 
            </td>
        </tr>
    </table>
    
    <p><img src = "DDSPCepstra_guitarset.svg"  width="60%"></p>
    
    
    
    <h3>DDSP Style Transfers: Vocals</h3>
    
    <table style="width:80%;">
        <tr>
            <td>
                <h4>Clean</h4>
                <audio controls>
                    <source src="ddsp_prince_vocalset_clean.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>50 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_vocalset_50.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>75 Echo</h4>
                <audio controls>
                    <source src="ddsp_prince_vocalset_75.m4a" type="audio/mpeg">
                  Your browser does not support the audio element.
                </audio> 
            </td>
            <td>
                <h4>100 Echo</h4>
    <audio controls>
        <source src="ddsp_prince_vocalset_100.m4a" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio> 
            </td>
        </tr>
    </table>
    
    <p><img src = "DDSPCepstra_vocalset.svg"  width="60%"></p>
    -->

<h3>Rave Style Transfers: Drums</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_groove_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_groove_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_groove_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_groove_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_groove.svg" width="60%"></p>



<h3>Rave Style Transfers: Acoustic Guitar</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_guitarset_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_guitarset_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_guitarset_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_guitarset_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_guitarset.svg" width="60%"></p>




<h3>Rave Style Transfer: Acoustic Guitar: Pseudorandom Echo Pattern @ 75 Lag</h3>


<h4>Hidden Pseudorandom Pattern</h4>

<textarea rows="10" cols="100" wrap="hard"> 1010101001001010110100100101010110011001001010110101101001010010100110101101010110010010100101001010110101010101010010010010101010101010110101001100101010010101010101001001010010101010101011001010010010010110101011010101010101101001011001011010100101010110110011011001011010110101100110101101001010101011001011010101010101010011010110100110101101001001101010101010110100101001101010101010011010101101011010010100110010101010110011010100101010110101010101010101010011010110010101001010100101010101101010110010101010101011010100110101011010110010101010101101001010101011001010101010010101010101011010101010101010110100100110100101010110010011010100101010110110010011010101011010101011010100110101101010100110011010010101101010110101010101001101010101010101010011011010101010101011010011010101010011001011010101101010101010110101101101101101001011011010101101100101101010101010101010101101001101010010101101011010100100110101101010101010101010100110101010101010101011001011010101101010100101010101101010101010101001010010100101
    </textarea> 
<p></p>
<audio controls>
    <source src="prince_guitarset_pn0.m4a" type="audio/mpeg">
    Your browser does not support the audio element.
</audio> 



<p><img src = "RavePNCepstra.svg"  width="60%"></p>


<h3>Rave Style Transfers: Vocals</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_vocalset_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_vocalset_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_vocalset_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_vocalset_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_vocalset.svg"  width="60%"></p>



<h3>Rave Style Transfers: Drums</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_groove_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_groove_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_groove_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_groove_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_groove.svg"  width="60%"></p>



<h3>Rave Style Transfers: Acoustic Guitar</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_guitarset_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_guitarset_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_guitarset_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_guitarset_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_guitarset.svg"  width="60%"></p>



<h3>Rave Style Transfers: Vocals</h3>

<table style="width:80%;">
    <tr>
        <td>
            <h4>Clean</h4>
            <audio controls>
                <source src="rave_prince_vocalset_clean.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>50 Echo</h4>
            <audio controls>
                <source src="rave_prince_vocalset_50.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>75 Echo</h4>
            <audio controls>
                <source src="rave_prince_vocalset_75.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 
        </td>
        <td>
            <h4>100 Echo</h4>
<audio controls>
    <source src="rave_prince_vocalset_100.m4a" type="audio/mpeg">
  Your browser does not support the audio element.
</audio> 
        </td>
    </tr>
</table>

<p><img src = "RaveCepstra_vocalset.svg"  width="60%"></p>





            <h3>Rave Demucs Results</h3>

            <h4>Original Mixture (AM Contra - Heart Peripheral from <a href = "https://sigsep.github.io/datasets/musdb.html">musdb test set</a>)</h4>
            <audio controls>
                <source src="OriginalMixture.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 

            <h4>Mixing Drums Model with 50 Echo, Guitar Model with 75 Echo, And Vocals with 100 Echo</h4>
            <audio controls>
                <source src="RaveMixed.m4a" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio> 

            <h4>Cepstra on Demixed Tracks, Obtained from <a href = "https://github.com/facebookresearch/demucs/tree/v2">Demucs</a>:</h4>
            <img src = "RaveDemixed.svg" width="60%">
            

</body>
</html>